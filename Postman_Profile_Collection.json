{
	"info": {
		"name": "User Profile Management API",
		"description": "Collection ƒë·ªÉ test c√°c API qu·∫£n l√Ω profile user",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:5297",
			"type": "string"
		},
		{
			"key": "accessToken",
			"value": "",
			"type": "string"
		},
		{
			"key": "userId",
			"value": "1",
			"type": "string"
		}
	],
	"item": [
		{
			"name": "0. Authentication",
			"item": [
				{
					"name": "Login (Get Access Token)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.data && jsonData.data.accessToken) {",
									"        pm.collectionVariables.set('accessToken', jsonData.data.accessToken);",
									"        pm.collectionVariables.set('userId', jsonData.data.userId);",
									"        console.log('‚úÖ Access Token saved: ' + jsonData.data.accessToken.substring(0, 20) + '...');",
									"        console.log('‚úÖ User ID saved: ' + jsonData.data.userId);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"identifier\": \"hoang@example.com\",\n  \"password\": \"yourpassword\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/auth/login",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"auth",
								"login"
							]
						},
						"description": "üîë Login ƒë·ªÉ l·∫•y access token. Token s·∫Ω t·ª± ƒë·ªông l∆∞u v√†o collection variable."
					},
					"response": []
				}
			]
		},
		{
			"name": "1. Profile Management",
			"item": [
				{
					"name": "Get Profile",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/users/profile",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"users",
								"profile"
							]
						},
						"description": "üìã L·∫•y th√¥ng tin profile ƒë·∫ßy ƒë·ªß c·ªßa user ƒëang ƒëƒÉng nh·∫≠p"
					},
					"response": []
				},
				{
					"name": "Update Profile",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"fullName\": \"Tr·∫ßn Ho√†ng Updated\",\n  \"gender\": \"Male\",\n  \"bio\": \"Full-stack Developer | Tech Enthusiast\",\n  \"isPrivate\": false,\n  \"dateOfBirth\": \"2000-05-15\",\n  \"address\": \"H·ªì Ch√≠ Minh\",\n  \"hometown\": \"ƒê√† N·∫µng\",\n  \"job\": \"Senior Developer\",\n  \"website\": \"https://hoangdev.com\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/users/profile",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"users",
								"profile"
							]
						},
						"description": "‚úèÔ∏è C·∫≠p nh·∫≠t th√¥ng tin c∆° b·∫£n (kh√¥ng c·∫ßn OTP)\n\n**Fields c√≥ th·ªÉ c·∫≠p nh·∫≠t:**\n- fullName\n- gender (Male/Female/Other)\n- bio\n- isPrivate (true/false)\n- dateOfBirth\n- address\n- hometown\n- job\n- website"
					},
					"response": []
				}
			]
		},
		{
			"name": "2. Change Email (OTP)",
			"item": [
				{
					"name": "Step 1: Request Change Email",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"newEmail\": \"newemail@example.com\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/users/profile/change-email/request",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"users",
								"profile",
								"change-email",
								"request"
							]
						},
						"description": "üìß B∆∞·ªõc 1: G·ª≠i OTP ƒë·∫øn email M·ªöI\n\n**L∆∞u √Ω:**\n- OTP s·∫Ω ƒë∆∞·ª£c g·ª≠i ƒë·∫øn email M·ªöI (kh√¥ng ph·∫£i email hi·ªán t·∫°i)\n- OTP c√≥ hi·ªáu l·ª±c 5 ph√∫t\n- T·ªëi ƒëa 5 l·∫ßn th·ª≠"
					},
					"response": []
				},
				{
					"name": "Step 2: Verify Change Email",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"newEmail\": \"newemail@example.com\",\n  \"otp\": \"123456\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/users/profile/change-email/verify",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"users",
								"profile",
								"change-email",
								"verify"
							]
						},
						"description": "‚úÖ B∆∞·ªõc 2: Verify OTP v√† ƒë·ªïi email\n\n**Nh·∫≠p:**\n- newEmail: Email m·ªõi (ph·∫£i gi·ªëng step 1)\n- otp: M√£ OTP nh·∫≠n ƒë∆∞·ª£c qua email"
					},
					"response": []
				}
			]
		},
		{
			"name": "3. Change Phone (OTP)",
			"item": [
				{
					"name": "Step 1: Request Change Phone",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"newPhone\": \"0987654321\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/users/profile/change-phone/request",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"users",
								"profile",
								"change-phone",
								"request"
							]
						},
						"description": "üì± B∆∞·ªõc 1: G·ª≠i OTP ƒë·ªÉ ƒë·ªïi s·ªë ƒëi·ªán tho·∫°i\n\n**L∆∞u √Ω:**\n- OTP s·∫Ω ƒë∆∞·ª£c g·ª≠i ƒë·∫øn EMAIL HI·ªÜN T·∫†I (kh√¥ng ph·∫£i SƒêT m·ªõi)\n- OTP c√≥ hi·ªáu l·ª±c 5 ph√∫t\n- T·ªëi ƒëa 5 l·∫ßn th·ª≠"
					},
					"response": []
				},
				{
					"name": "Step 2: Verify Change Phone",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"newPhone\": \"0987654321\",\n  \"otp\": \"123456\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/users/profile/change-phone/verify",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"users",
								"profile",
								"change-phone",
								"verify"
							]
						},
						"description": "‚úÖ B∆∞·ªõc 2: Verify OTP v√† ƒë·ªïi SƒêT\n\n**Nh·∫≠p:**\n- newPhone: SƒêT m·ªõi (ph·∫£i gi·ªëng step 1)\n- otp: M√£ OTP nh·∫≠n ƒë∆∞·ª£c qua email"
					},
					"response": []
				}
			]
		},
		{
			"name": "4. Avatar Management",
			"item": [
				{
					"name": "Upload Avatar (Simple)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}",
								"type": "text"
							}
						],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "avatarFile",
									"type": "file",
									"src": [],
									"description": "‚ö†Ô∏è Ch·ªçn file ·∫£nh (.jpg, .png, .gif, max 5MB)"
								},
								{
									"key": "createPost",
									"value": "false",
									"type": "text",
									"description": "false = ch·ªâ update avatar, kh√¥ng ƒëƒÉng b√†i"
								}
							]
						},
						"url": {
							"raw": "{{baseUrl}}/api/users/profile/avatar",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"users",
								"profile",
								"avatar"
							]
						},
						"description": "üñºÔ∏è Upload avatar ƒë∆°n gi·∫£n (kh√¥ng t·∫°o post)\n\n**K·∫øt qu·∫£:**\n- File l∆∞u t·∫°i: Assets/Images/{username}_{randomCode}.jpg\n- C·∫≠p nh·∫≠t avatar_url trong database\n- Kh√¥ng t·∫°o b√†i post"
					},
					"response": []
				},
				{
					"name": "Upload Avatar + Create Post",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}",
								"type": "text"
							}
						],  
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "avatarFile",
									"type": "file",
									"src": [],
									"description": "‚ö†Ô∏è Ch·ªçn file ·∫£nh (.jpg, .png, .gif, max 5MB)"
								},
								{
									"key": "createPost",
									"value": "true",
									"type": "text",
									"description": "true = update avatar V√Ä ƒëƒÉng b√†i"
								},
								{
									"key": "postCaption",
									"value": "·∫¢nh ƒë·∫°i di·ªán m·ªõi c·ªßa t√¥i üéâ",
									"type": "text",
									"description": "Caption cho b√†i post"
								},
								{
									"key": "postLocation",
									"value": "H√† N·ªôi",
									"type": "text",
									"description": "Location (optional)"
								},
								{
									"key": "postPrivacy",
									"value": "Public",
									"type": "text",
									"description": "Public / Friends / Private"
								}
							]
						},
						"url": {
							"raw": "{{baseUrl}}/api/users/profile/avatar",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"users",
								"profile",
								"avatar"
							]
						},
						"description": "üñºÔ∏èüìù Upload avatar V√Ä t·∫°o b√†i post v·ªõi ·∫£nh ƒë√≥\n\n**K·∫øt qu·∫£:**\n- File l∆∞u t·∫°i: Assets/Images/{username}_{randomCode}.jpg\n- C·∫≠p nh·∫≠t avatar_url trong database\n- T·∫°o 1 b√†i post m·ªõi trong b·∫£ng Posts\n- T·∫°o 1 media trong b·∫£ng PostMedia"
					},
					"response": []
				},
				{
					"name": "Get Avatar by UserId",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/users/profile/avatar/{{userId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"users",
								"profile",
								"avatar",
								"{{userId}}"
							]
						},
						"description": "üñºÔ∏è Xem avatar c·ªßa user (kh√¥ng c·∫ßn authentication)\n\n**Response:** File ·∫£nh tr·ª±c ti·∫øp (image/jpeg)"
					},
					"response": []
				},
				{
					"name": "Remove Avatar",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{accessToken}}",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/api/users/profile/avatar",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"users",
								"profile",
								"avatar"
							]
						},
						"description": "üóëÔ∏è G·ª° avatar (x√≥a ·∫£nh ƒë·∫°i di·ªán)\n\n**K·∫øt qu·∫£:**\n- Reset avatar_url v·ªÅ null trong database\n- X√≥a file ·∫£nh trong Assets/Images/\n- User s·∫Ω kh√¥ng c√≥ avatar"
					},
					"response": []
				}
			]
		}
	]
}
